<!DOCTYPE html>
<html>

<!-- Load core scripts -->
<head>
  <title>RNA Sequence Converter</title>
  <script src="https://unpkg.com/vue"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
  <style>
    body {
      font-family: 'Montserrat', sans-serif;
      font-size: 0.8em;
    }

    .app {
      padding: 20px;
      justify-content: center;
      display: flex;
    }

    .controls {
      display: inline-block;
      background-color: #f3f3f3;
      padding: 20px;
      border: solid 2px #aaa;
    }
  </style>
</head>


<!-- Define the layout -->
<body>
<div id="app" class="app">
  <div>
    <h1>RNA sequence converter</h1>
    <div class="controls">
      <h2>Disclaimer</h2>
          <p>This code is only meant to make Nastia's and Walker's lifes easier</p>
          <p>Use it at your own risk. After running this, you may choose to compare the result to your manual conversion as this is severely undertested</p>

      <h2>Convert sequence</h2>
          <p>Convert an RNA sequence into a sequence that you can directly feed to the machine.</p>
          <p>Note: only ACGTU are accepted. All T's will be converted to U</p>
          <p>Enter a sequence below</p>

          <input v-model="sequence" placeholder="Enter sequence">

      <h2>Ends</h2>
          <p>Synthego standard RNA mods include 3 phosphate bridges at the 5'- and 3'-ends being thiophosphorylated</p>
          <p>Currently we do not handle base modifications</p>

          <p>Thiophosphates & OMe at the 5'-end: <input v-model="fiveend" placeholder="3"></p>
          <p>Thiophosphates & OMe at the 3'-end: <input v-model="threeend" placeholder="3"></p>

      <h2>Copy your TLS</h2>
          <p><button v-on:click="get_tls">Get my TLS</button></p>
          <p>Standard three letter sequence is:</p>
          <p style="color: #04f; font-weight: bold">{{ tls }}</p>
     
     
      <h2>Additional modifications: replacements</h2>

          <p>Replace at: <input v-model="replacement_pos" placeholder="0"></p>
        
          <p>With nucleotide: <select v-model="replacement_base">
              <option disabled value="">Please select one</option>
              <option>A</option>
              <option>C</option>
              <option>G</option>
              <option>U</option>
              <option>X</option>
          </select></p>

          <p>
            <input type="radio" name = "twoprime" id="vanilla" value="vanilla" v-model="twoprime">
              <label for="vanilla">Vanilla</label>
              <br>
            <input type="radio" name = "twoprime" id="methyl" value="methyl" v-model="twoprime">
              <label for="methyl">2'-OMe</label>
              <br>
            <input type="radio" name = "twoprime" id="fluoro" value="fluoro" v-model="twoprime">
              <label for="fluoro">2'-Fluoro</label>
              <br>
           </p>

           <p>Thiophosphorylated: <input type="checkbox" id="thiophosphoryl" v-model="thiophosphoryl">
           <!-- <label for="checkbox">{{ thiophosph }}</label></p> -->
        
           <p><button v-on:click="get_repl_tls">Get my TLS</button></p>
           <p>Sequence with replacement is:</p>
           <p style="color: #04f; font-weight: bold">{{ tls_replacement }}</p>
          
    </div>
     <p style="font-size: 0.6em"><i>Version {{ version }} | Developed by Anastasia Kadina | Powered by <a href="http://sciris.org">Sciris</a></i></p>
  </div>
</div>
</body>

<!-- Define the functionality -->
<script>
  var vm = new Vue({
    el: '#app',

    data() {
      return {
        sequence: 'No sequence',
        fiveend: 3,
        threeend: 3,
        tls: 'No TLS',
        tls_replacement: 'No TLS',
        replacement_pos: '',
        replacement_base: '',
        thiophosph: '',
        thiophosphoryl: false,
        version: 'Not loaded',
      }
    },

    created () {
      var url = '/api/get_version';
      axios.post(url)
              .then(function (response) {
                vm.version = response.data
              })
    },
    
    methods: {

      get_tls: function () {
        console.log('get_tls() called');
        var url = '/api/get_tls';
        url += '/' + vm.sequence;
        url += '/' + vm.fiveend;
        url += '/' + vm.threeend;
        axios.post(url) // Use a POST request to pass along the value -- this will be simplified in future!
                .then(function (response) {
                  vm.tls = response.data
                })
      },
      
      get_repl_tls: function () {
        var url = '/api/get_repl_tls';
        url += '/' + vm.tls;
        url += '/' + vm.replacement_pos;
        url += '/' + vm.replacement_base;
        url += '/' + vm.twoprime;
        url += '/' + vm.thiophosphoryl;
        axios.post(url) // Use a POST request to pass along the value -- this will be simplified in future!
                .then(function (response) {
                  vm.tls_replacement = response.data
                })
      },
    }
  })
</script>

</html>
